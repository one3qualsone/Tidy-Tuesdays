{
  "hash": "3a072f4aba9787688ba77fbb86b6fe3e",
  "result": {
    "markdown": "---\ntitle: \"Week 3: Global Coffee Production\"\ndescription: \"Exploring trends in coffee production, exports, and consumption\"\ndate: \"2025-03-09\"\ncategories: [agriculture, economics, maps]\nimage: \"thumbnail.png\"\nexecute:\n  echo: true\n  warning: false\n---\n\n\n\n\n## Introduction\n\nFor this week's Tidy Tuesday, I explored global coffee production data. Coffee is one of the world's most traded agricultural commodities, with millions of people involved in its production, processing, and distribution. This analysis examines production trends, export patterns, and the relationship between price, variety, and growing conditions.\n\n## The Data\n\nOur dataset includes information on coffee production, exports, domestic consumption, prices, and growing conditions across 15 major coffee-producing countries from 2015 to 2024.\n\nLet's take a look at the first few rows of our dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using kable for better table formatting\nhead(coffee_data) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> country </th>\n   <th style=\"text-align:right;\"> year </th>\n   <th style=\"text-align:right;\"> production </th>\n   <th style=\"text-align:right;\"> exports </th>\n   <th style=\"text-align:right;\"> domestic_consumption </th>\n   <th style=\"text-align:right;\"> price </th>\n   <th style=\"text-align:left;\"> variety </th>\n   <th style=\"text-align:right;\"> altitude </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Brazil </td>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 52368 </td>\n   <td style=\"text-align:right;\"> 30310.483 </td>\n   <td style=\"text-align:right;\"> 22057.517 </td>\n   <td style=\"text-align:right;\"> 1.645784 </td>\n   <td style=\"text-align:left;\"> Robusta </td>\n   <td style=\"text-align:right;\"> 783 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Vietnam </td>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 26097 </td>\n   <td style=\"text-align:right;\"> 18635.728 </td>\n   <td style=\"text-align:right;\"> 7461.272 </td>\n   <td style=\"text-align:right;\"> 1.729525 </td>\n   <td style=\"text-align:left;\"> Robusta </td>\n   <td style=\"text-align:right;\"> 917 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Colombia </td>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 13251 </td>\n   <td style=\"text-align:right;\"> 7577.217 </td>\n   <td style=\"text-align:right;\"> 5673.783 </td>\n   <td style=\"text-align:right;\"> 4.361002 </td>\n   <td style=\"text-align:left;\"> Arabica </td>\n   <td style=\"text-align:right;\"> 1202 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Indonesia </td>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 11169 </td>\n   <td style=\"text-align:right;\"> 7603.348 </td>\n   <td style=\"text-align:right;\"> 3565.652 </td>\n   <td style=\"text-align:right;\"> 2.141132 </td>\n   <td style=\"text-align:left;\"> Robusta </td>\n   <td style=\"text-align:right;\"> 1025 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ethiopia </td>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 6633 </td>\n   <td style=\"text-align:right;\"> 4157.706 </td>\n   <td style=\"text-align:right;\"> 2475.294 </td>\n   <td style=\"text-align:right;\"> 1.877499 </td>\n   <td style=\"text-align:left;\"> Arabica </td>\n   <td style=\"text-align:right;\"> 1348 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Honduras </td>\n   <td style=\"text-align:right;\"> 2015 </td>\n   <td style=\"text-align:right;\"> 5096 </td>\n   <td style=\"text-align:right;\"> 2784.810 </td>\n   <td style=\"text-align:right;\"> 2311.190 </td>\n   <td style=\"text-align:right;\"> 2.287659 </td>\n   <td style=\"text-align:left;\"> Arabica </td>\n   <td style=\"text-align:right;\"> 858 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Production vs. Export Analysis\n\nLet's also look at a summary of production and export data by country:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate average production and exports by country\ncountry_summary <- coffee_data %>%\n  group_by(country) %>%\n  summarize(\n    avg_production = mean(production),\n    avg_exports = mean(exports),\n    export_ratio = mean(exports/production) * 100\n  ) %>%\n  arrange(desc(avg_production))\n\n# Display nicely formatted table\ncountry_summary %>%\n  mutate(\n    avg_production = round(avg_production, 0),\n    avg_exports = round(avg_exports, 0),\n    export_ratio = round(export_ratio, 1)\n  ) %>%\n  rename(\n    Country = country,\n    \"Avg Production\" = avg_production,\n    \"Avg Exports\" = avg_exports,\n    \"Export Ratio (%)\" = export_ratio\n  ) %>%\n  kable(caption = \"Coffee Production and Export Summary by Country\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE) %>%\n  row_spec(1:3, background = \"#F8F8DC\")  # Highlight top 3 producers\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Coffee Production and Export Summary by Country</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Country </th>\n   <th style=\"text-align:right;\"> Avg Production </th>\n   <th style=\"text-align:right;\"> Avg Exports </th>\n   <th style=\"text-align:right;\"> Export Ratio (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(248, 248, 220, 255) !important;\"> Brazil </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 54795 </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 39372 </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 71.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(248, 248, 220, 255) !important;\"> Vietnam </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 26571 </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 17204 </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 64.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;background-color: rgba(248, 248, 220, 255) !important;\"> Colombia </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 13525 </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 9071 </td>\n   <td style=\"text-align:right;background-color: rgba(248, 248, 220, 255) !important;\"> 66.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Indonesia </td>\n   <td style=\"text-align:right;\"> 10959 </td>\n   <td style=\"text-align:right;\"> 7740 </td>\n   <td style=\"text-align:right;\"> 70.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Ethiopia </td>\n   <td style=\"text-align:right;\"> 7266 </td>\n   <td style=\"text-align:right;\"> 4325 </td>\n   <td style=\"text-align:right;\"> 59.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Kenya </td>\n   <td style=\"text-align:right;\"> 5276 </td>\n   <td style=\"text-align:right;\"> 3876 </td>\n   <td style=\"text-align:right;\"> 72.7 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> India </td>\n   <td style=\"text-align:right;\"> 5237 </td>\n   <td style=\"text-align:right;\"> 3818 </td>\n   <td style=\"text-align:right;\"> 71.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Nicaragua </td>\n   <td style=\"text-align:right;\"> 5077 </td>\n   <td style=\"text-align:right;\"> 3550 </td>\n   <td style=\"text-align:right;\"> 70.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Guatemala </td>\n   <td style=\"text-align:right;\"> 5075 </td>\n   <td style=\"text-align:right;\"> 3383 </td>\n   <td style=\"text-align:right;\"> 66.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Uganda </td>\n   <td style=\"text-align:right;\"> 4936 </td>\n   <td style=\"text-align:right;\"> 3803 </td>\n   <td style=\"text-align:right;\"> 77.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Tanzania </td>\n   <td style=\"text-align:right;\"> 4878 </td>\n   <td style=\"text-align:right;\"> 3336 </td>\n   <td style=\"text-align:right;\"> 67.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Honduras </td>\n   <td style=\"text-align:right;\"> 4742 </td>\n   <td style=\"text-align:right;\"> 2843 </td>\n   <td style=\"text-align:right;\"> 61.3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Peru </td>\n   <td style=\"text-align:right;\"> 4581 </td>\n   <td style=\"text-align:right;\"> 3065 </td>\n   <td style=\"text-align:right;\"> 67.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Costa Rica </td>\n   <td style=\"text-align:right;\"> 4529 </td>\n   <td style=\"text-align:right;\"> 2840 </td>\n   <td style=\"text-align:right;\"> 62.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Mexico </td>\n   <td style=\"text-align:right;\"> 4283 </td>\n   <td style=\"text-align:right;\"> 2898 </td>\n   <td style=\"text-align:right;\"> 67.2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Global Coffee Production Trends\n\nFirst, let's examine how coffee production has changed over the past decade for the top producing countries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get top producers by average production\ntop_producers <- coffee_data %>%\n  group_by(country) %>%\n  summarize(avg_production = mean(production)) %>%\n  arrange(desc(avg_production)) %>%\n  head(5) %>%\n  pull(country)\n\n# Filter for top producers\ntop_producers_data <- coffee_data %>%\n  filter(country %in% top_producers)\n\n# Create plot\nggplot(top_producers_data, aes(x = year, y = production/1000, color = country)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2) +\n  labs(\n    title = \"Coffee Production Trends (2015-2024)\",\n    subtitle = \"Top 5 Coffee Producing Countries\",\n    x = \"Year\",\n    y = \"Production (Millions of 60kg bags)\",\n    color = \"Country\"\n  ) +\n  scale_x_continuous(breaks = years) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"bottom\",\n    panel.grid.minor = element_blank()\n  ) +\n  scale_color_viridis(discrete = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Production vs. Export\n\nNext, let's analyze the relationship between production and exports for different countries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create bar chart comparing production and exports\nggplot(country_summary, aes(x = reorder(country, avg_production))) +\n  geom_bar(aes(y = avg_production/1000, fill = \"Production\"), stat = \"identity\", alpha = 0.7) +\n  geom_bar(aes(y = avg_exports/1000, fill = \"Exports\"), stat = \"identity\", alpha = 0.9) +\n  coord_flip() +\n  labs(\n    title = \"Coffee Production vs. Exports by Country\",\n    subtitle = \"Average values for 2015-2024\",\n    x = NULL,\n    y = \"Coffee (Millions of 60kg bags)\",\n    fill = NULL\n  ) +\n  scale_fill_manual(values = c(\"Production\" = \"#8C510A\", \"Exports\" = \"#DFC27D\")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n## Price vs. Altitude\n\nLet's explore the relationship between coffee growing altitude and price:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate average altitude and price by country and variety\naltitude_price <- coffee_data %>%\n  group_by(country, variety) %>%\n  summarize(\n    avg_altitude = mean(altitude),\n    avg_price = mean(price)\n  )\n\n# Create scatter plot\nggplot(altitude_price, aes(x = avg_altitude, y = avg_price, color = variety, label = country)) +\n  geom_point(size = 4, alpha = 0.8) +\n  geom_text(hjust = -0.2, vjust = 0, size = 3) +\n  labs(\n    title = \"Relationship Between Growing Altitude and Coffee Price\",\n    subtitle = \"Average altitude vs. price by country and variety\",\n    x = \"Altitude (meters above sea level)\",\n    y = \"Price (USD per pound)\",\n    color = \"Variety\"\n  ) +\n  scale_color_manual(values = c(\"Arabica\" = \"#1B9E77\", \"Robusta\" = \"#D95F02\")) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n## Domestic Consumption Trends\n\nFinally, let's examine domestic consumption trends in major coffee-producing countries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate proportion of production consumed domestically\nconsumption_trends <- coffee_data %>%\n  group_by(country, year) %>%\n  summarize(\n    consumption_ratio = domestic_consumption / production * 100\n  )\n\n# Focus on interesting countries with varying domestic consumption patterns\nselected_countries <- c(\"Brazil\", \"Ethiopia\", \"Vietnam\", \"Colombia\", \"Mexico\")\n\n# Filter for selected countries\nselected_consumption <- consumption_trends %>%\n  filter(country %in% selected_countries)\n\n# Create line plot\nggplot(selected_consumption, aes(x = year, y = consumption_ratio, color = country)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2) +\n  labs(\n    title = \"Domestic Coffee Consumption Trends\",\n    subtitle = \"Percentage of production consumed domestically\",\n    x = \"Year\",\n    y = \"Domestic Consumption (%)\",\n    color = \"Country\"\n  ) +\n  scale_x_continuous(breaks = years) +\n  scale_y_continuous(limits = c(0, 100)) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    legend.position = \"bottom\",\n    panel.grid.minor = element_blank()\n  ) +\n  scale_color_viridis(discrete = TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n## Key Findings\n\nFrom our analysis, we can observe several interesting patterns:\n\n1. **Production Dominance**: Brazil consistently leads global coffee production by a significant margin, followed by Vietnam. Together, these two countries account for nearly half of global coffee production.\n\n2. **Export Patterns**: While some countries like Vietnam export the vast majority of their coffee, others like Ethiopia and Brazil retain a significant proportion for domestic consumption.\n\n3. **Altitude and Price Relationship**: There's a strong positive correlation between growing altitude and coffee price. Countries growing Arabica coffee at high altitudes, like Colombia and Ethiopia, generally command higher prices.\n\n4. **Variety Premium**: Arabica coffee consistently fetches higher prices than Robusta, reflecting consumer preferences and the different flavor profiles of these varieties.\n\n5. **Domestic Consumption Trends**: Brazil not only leads in production but also has the highest domestic consumption among producing countries, with approximately 30-40% of its production consumed locally.\n\n## Conclusions\n\nThis analysis highlights the complex dynamics of the global coffee market. Production is concentrated in a few major countries, but various factors including growing conditions, variety, and local consumption patterns create a diverse landscape.\n\nFor coffee-producing countries, these findings suggest several potential strategies:\n- Higher-altitude regions may benefit from focusing on premium Arabica production\n- Countries with established domestic markets (like Brazil) have more stable demand\n- Smaller producers might differentiate themselves through specialty varieties or sustainable practices\n\nFor further research, it would be valuable to examine:\n- The impact of climate change on growing regions\n- Fair trade certification and its effect on prices\n- The relationship between coffee quality scores and price premiums\n\n## Resources and Further Reading\n\n- International Coffee Organization: [ICO](https://www.ico.org/)\n- Specialty Coffee Association: [SCA](https://sca.coffee/)\n- Coffee Research Institute: [CRI](https://www.coffeeresearch.org/)\n\n\n::: {.cell}\n\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}