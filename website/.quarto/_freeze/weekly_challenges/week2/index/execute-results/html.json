{
  "hash": "96be08a9846e82a8d560cfe8fffd6ede",
  "result": {
    "markdown": "---\ntitle: \"Week 2: Global Air Quality\"\ndescription: \"Analyzing air quality measurements across major global cities\"\ndate: \"2025-02-12\"\ncategories: [time series, air quality, environmental]\nimage: \"thumbnail.png\"\nexecute:\n  echo: true\n  warning: false\n---\n\n\n\n\n## Introduction\n\nThis week's Tidy Tuesday focused on global air quality data. Air pollution is a major environmental risk to health worldwide, with outdoor air pollution responsible for millions of deaths annually. Understanding air quality trends across major cities can help inform policy decisions and public health initiatives.\n\n## The Data\n\nThe dataset contains air quality measurements from major cities around the world, including:\n\n- Air Quality Index (AQI)\n- PM2.5 levels (fine particulate matter)\n- PM10 levels (coarse particulate matter)\n- NO2 (nitrogen dioxide) levels\n\nLet's take a look at the first few rows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Using kable for better table formatting\nhead(air_quality) %>%\n  kable() %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> city </th>\n   <th style=\"text-align:left;\"> date </th>\n   <th style=\"text-align:right;\"> aqi </th>\n   <th style=\"text-align:right;\"> pm25 </th>\n   <th style=\"text-align:right;\"> pm10 </th>\n   <th style=\"text-align:right;\"> no2 </th>\n   <th style=\"text-align:left;\"> quality_category </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> London </td>\n   <td style=\"text-align:left;\"> 2024-01-01 </td>\n   <td style=\"text-align:right;\"> 178 </td>\n   <td style=\"text-align:right;\"> 70.11916 </td>\n   <td style=\"text-align:right;\"> 106.88484 </td>\n   <td style=\"text-align:right;\"> 48.54721 </td>\n   <td style=\"text-align:left;\"> Unhealthy </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> New York </td>\n   <td style=\"text-align:left;\"> 2024-01-01 </td>\n   <td style=\"text-align:right;\"> 198 </td>\n   <td style=\"text-align:right;\"> 107.92362 </td>\n   <td style=\"text-align:right;\"> 197.37991 </td>\n   <td style=\"text-align:right;\"> 44.10613 </td>\n   <td style=\"text-align:left;\"> Unhealthy </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Tokyo </td>\n   <td style=\"text-align:left;\"> 2024-01-01 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 11.32796 </td>\n   <td style=\"text-align:right;\"> 21.75825 </td>\n   <td style=\"text-align:right;\"> 10.47382 </td>\n   <td style=\"text-align:left;\"> Good </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Paris </td>\n   <td style=\"text-align:left;\"> 2024-01-01 </td>\n   <td style=\"text-align:right;\"> 189 </td>\n   <td style=\"text-align:right;\"> 93.51966 </td>\n   <td style=\"text-align:right;\"> 117.13194 </td>\n   <td style=\"text-align:right;\"> 38.54324 </td>\n   <td style=\"text-align:left;\"> Unhealthy </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Beijing </td>\n   <td style=\"text-align:left;\"> 2024-01-01 </td>\n   <td style=\"text-align:right;\"> 69 </td>\n   <td style=\"text-align:right;\"> 23.44470 </td>\n   <td style=\"text-align:right;\"> 57.88696 </td>\n   <td style=\"text-align:right;\"> 31.75724 </td>\n   <td style=\"text-align:left;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> London </td>\n   <td style=\"text-align:left;\"> 2024-01-02 </td>\n   <td style=\"text-align:right;\"> 137 </td>\n   <td style=\"text-align:right;\"> 49.93188 </td>\n   <td style=\"text-align:right;\"> 99.80880 </td>\n   <td style=\"text-align:right;\"> 68.19650 </td>\n   <td style=\"text-align:left;\"> Unhealthy for Sensitive Groups </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Air Quality Over Time\n\nLet's visualize how air quality has changed over time in different cities:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(air_quality, aes(x = date, y = aqi, color = city)) +\n  geom_line() +\n  geom_smooth(method = \"loess\", se = FALSE, alpha = 0.5) +\n  facet_wrap(~city, ncol = 2) +\n  labs(\n    title = \"Air Quality Index Over Time\",\n    subtitle = \"January - March 2024\",\n    x = \"Date\",\n    y = \"Air Quality Index (AQI)\",\n    color = \"City\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    strip.background = element_rect(fill = \"lightblue\", color = NA),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n## Comparing Pollutant Levels\n\nLet's compare the different pollutant levels across cities:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nair_quality %>%\n  group_by(city) %>%\n  summarize(\n    avg_aqi = mean(aqi),\n    avg_pm25 = mean(pm25),\n    avg_pm10 = mean(pm10),\n    avg_no2 = mean(no2)\n  ) %>%\n  tidyr::pivot_longer(\n    cols = starts_with(\"avg_\"),\n    names_to = \"pollutant\",\n    values_to = \"value\"\n  ) %>%\n  mutate(\n    pollutant = case_when(\n      pollutant == \"avg_aqi\" ~ \"Air Quality Index\",\n      pollutant == \"avg_pm25\" ~ \"PM2.5\",\n      pollutant == \"avg_pm10\" ~ \"PM10\",\n      pollutant == \"avg_no2\" ~ \"NO2\"\n    )\n  ) %>%\n  ggplot(aes(x = reorder(city, value), y = value, fill = city)) +\n  geom_col() +\n  facet_wrap(~pollutant, scales = \"free_y\", ncol = 2) +\n  coord_flip() +\n  labs(\n    title = \"Average Pollutant Levels by City\",\n    subtitle = \"January - March 2024\",\n    x = NULL,\n    y = \"Concentration\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"none\",\n    strip.background = element_rect(fill = \"lightgray\", color = NA),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=960}\n:::\n:::\n\n\n## Air Quality Category Distribution\n\nLet's examine the distribution of air quality categories across cities:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot directly with the original styling\nggplot(air_quality, aes(x = city, y = aqi, fill = quality_category)) +\n  geom_boxplot(alpha = 0.8) +\n  scale_fill_manual(values = c(\n    \"Good\" = \"#91CF60\",               # A softer green\n    \"Moderate\" = \"#FFFFBF\",           # Pale yellow\n    \"Unhealthy for Sensitive Groups\" = \"#FEE08B\", # Soft orange\n    \"Unhealthy\" = \"#FC8D59\",          # Muted red-orange\n    \"Very Unhealthy\" = \"#D73027\",     # Muted red\n    \"Hazardous\" = \"#A50026\"           # Darker red\n  )) +\n  labs(\n    title = \"Distribution of Air Quality Index by City\",\n    x = \"City\",\n    y = \"Air Quality Index (AQI)\",\n    fill = \"Air Quality Category\"\n  ) +\n  theme_minimal() +\n  theme(\n    legend.position = \"bottom\",\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n## Correlation Between Pollutants\n\nLet's explore the correlation between different pollutants:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nair_quality %>%\n  select(aqi, pm25, pm10, no2) %>%\n  cor() %>%\n  as.data.frame() %>%\n  tibble::rownames_to_column(\"pollutant1\") %>%\n  tidyr::pivot_longer(-pollutant1, names_to = \"pollutant2\", values_to = \"correlation\") %>%\n  ggplot(aes(x = pollutant1, y = pollutant2, fill = correlation)) +\n  geom_tile() +\n  geom_text(aes(label = round(correlation, 2)), color = \"white\", size = 4) +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0.5) +\n  labs(\n    title = \"Correlation Between Pollutants\",\n    x = NULL,\n    y = NULL,\n    fill = \"Correlation\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n## Key Findings\n\nFrom our analysis, we can observe:\n\n1. **City Differences**: Beijing shows the highest average AQI levels, followed by Tokyo and New York.\n2. **Pollutant Relationships**: PM10 and AQI show the strongest correlation, which is expected as PM10 is a major component of air quality calculations.\n3. **Seasonal Patterns**: All cities show some fluctuation in air quality over the period, with some improvement trends visible in specific cities.\n4. **Quality Categories**: London has the highest percentage of \"Good\" air quality days, while Beijing has the highest percentage of \"Unhealthy\" days.\n\n## Conclusions\n\nThis analysis demonstrates the variability in air quality across major global cities. The data shows that while some cities struggle with consistently poor air quality, others maintain relatively good air quality levels throughout the period. These findings highlight the need for continued monitoring and targeted interventions in cities with persistent air quality issues.\n\nFor a more comprehensive analysis, future work could explore:\n- Correlation with weather patterns\n- Impact of policy interventions on air quality\n- Relationship between air quality and health outcomes in each city\n\n## Sources and Further Reading\n\n- World Health Organization Air Quality Guidelines\n- Environmental Protection Agency Air Quality Index\n- [Our World in Data - Air Pollution](https://ourworldindata.org/air-pollution)\n\n\n::: {.cell}\n\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}